# 创作控制台精简改版方案 v1.0（审查稿）

## 1. 目标与边界

1. 目标：把“创作控制台”改成单一主任务页面，降低冗余控制，保留高频能力（开始生成、续写、停止、预览）。
2. 目标：减少重复入口，避免“同一参数多处设置”。
3. 目标：将“计划/结构”与“写作执行”职责分离，保持信息层级清晰。
4. 边界：本次仅改 `/project/:projectId/write` 页面，不改章节工作台核心流程，不改后端生成协议（除非前端需要轻微字段透传）。

## 2. 竞品调研结论（用于设计依据）

1. Novelcrafter：写作页强调专注，规划信息作为辅助侧栏，不把所有控制堆在主编辑区。  
   https://docs.novelcrafter.com/en/articles/8675752-the-write-interface
2. Sudowrite：把项目组织、主写作区、历史/工具栏分区，续写和上下文能力绑定到写作动作而非大量全局开关。  
   https://docs.sudowrite.com/getting-started/dQph1snuwbfMWG9wRjsNug/interface/ubBg2ZEoAwasV98E3ZBwjn  
   https://docs.sudowrite.com/using-sudowrite/1ow1qkGqof9rtcyGnrWUBS/outline/3owKyHXUm1bCdp41b2Npjk  
   https://docs.sudowrite.com/using-sudowrite/1ow1qkGqof9rtcyGnrWUBS/write/pvxUvbQqYybfEosqx1sXjY
3. Reedsy Studio：主写作流程简洁，目标和统计作为辅助模块，不干扰主要写作入口。  
   https://reedsy.com/write-a-book
4. Dabble：通过多视图切换（而非单页堆叠）管理剧情/笔记/正文，强调 focus 模式。  
   https://help.dabblewriter.com/en/articles/2752981-the-10-book-views-of-dabble
5. Notion AI：风格控制偏“规则化提示”而不是“重 UI 控件”。  
   https://www.notion.com/product/ai/use-cases/write-in-your-style

## 3. 现状问题（基于当前实现）

1. 顶部预设与下方模式按钮重复（双入口改同一组参数）。
2. 左侧同时放目录、统计、日志，信息竞争强。
3. 阅读模式、导出、模板应用都在顶部，操作层级混杂。
4. 高级设置自动保存会频繁打断（toast 过多）。
5. 页面“创作入口”和“创作结果管理”耦合偏重，导致认知负担高。

涉及文件：

1. `/Volumes/Work/Projects/Morpheus/frontend/src/pages/WritingConsolePage.tsx`
2. `/Volumes/Work/Projects/Morpheus/frontend/src/index.css`
3. `/Volumes/Work/Projects/Morpheus/frontend/src/pages/__tests__/WritingConsolePage.test.tsx`

## 4. 精简原则（本次改造强约束）

1. 一个主任务：写和续写。
2. 一个主入口：底部操作条。
3. 一个进度反馈区：日志抽屉，不再常驻抢视觉。
4. 一组参数只出现一次。
5. 默认简洁，高级设置折叠可用。

## 5. 信息架构重组（建议采用 B 方案）

1. 顶部区：仅保留标题、项目名、当前模式摘要、模板入口（单入口）。
2. 中间主区：左侧为流式正文预览（主视觉）；右侧改为“可折叠辅助面板”（目录/日志/统计三选一标签页）。
3. 底部固定操作条：提示词输入 + 开始生成 + 从最新章节续写 + 停止 + 高级设置抽屉。
4. 阅读模式、导出：移动到“正文工具条”内，不在全局头部常驻。
5. 模板快捷 chip：取消多按钮，改“模板下拉/弹窗一次性套用”。

## 6. 模块保留/迁移/删除清单

| 模块 | 处理 | 说明 |
|---|---|---|
| 开始生成 | 保留 | 主操作，位置改为底部固定条 |
| 从最新章节续写 | 保留 | 主操作，紧邻开始生成 |
| 停止 | 保留 | 主操作，紧邻开始生成 |
| 提示词输入框 | 保留 | 主输入，不变 |
| 高级设置（章节数/字数/自动审批） | 保留 | 仍折叠，但移入底部抽屉 |
| 预设按钮（试跑4章/标准整卷/整本冲刺） | 删除 | 与模式/范围重复 |
| 顶部模板 chips（多枚） | 删除 | 改成单一模板入口 |
| 左侧常驻日志 | 迁移 | 改为右侧面板“日志”标签 |
| 左侧常驻统计 | 迁移 | 改为右侧面板“统计”标签 |
| 左侧常驻目录 | 迁移 | 改为右侧面板“目录”标签 |
| 顶部阅读模式按钮 | 迁移 | 移到正文区工具条 |
| 顶部导出菜单 | 迁移 | 移到正文区工具条 |

## 7. 交互流程（改后）

1. 用户输入一句话梗概。
2. 点击“开始生成”或“从最新章节续写”。
3. 主区直接看到实时正文；右侧面板默认收起。
4. 若需看日志/统计/目录，点右侧面板标签展开。
5. 若需调参数，展开“高级设置抽屉”；保存为静默，不弹频繁 toast。

## 8. 视觉与样式规范（落地项）

1. 页面主视觉重心放正文，不让辅助信息抢焦点。
2. 操作条固定底部，避免滚动后找不到主按钮。
3. 日志字体与正文明显区分（更小、更淡）。
4. 统计卡片改为紧凑行，避免大块占位。
5. 高级设置输入框保留“可清空再输入”行为。

样式改动主文件：

1. `/Volumes/Work/Projects/Morpheus/frontend/src/index.css`

## 9. 技术实现计划（分阶段）

1. Phase 1：结构重排  
   改 `WritingConsolePage.tsx` 的 DOM 区块顺序，移除重复按钮区域，新增“右侧辅助面板 tabs”。
2. Phase 2：状态与行为整合  
   将日志/目录/统计切换状态统一，去掉重复来源；保留现有 SSE 与续写逻辑不改协议。
3. Phase 3：样式重构  
   清理 `.writing-header__presets` 相关样式；新增底部固定条和侧面抽屉样式。
4. Phase 4：测试与回归  
   更新单测快照和交互用例；Playwright 截图校验主流程。

## 10. 测试验收标准（通过线）

1. 页面首屏只出现一组主操作，不再有重复参数入口。
2. “开始生成/续写/停止”在任何滚动位置都可见可点。
3. 高级设置可改、可持久化、不卡输入。
4. 日志与目录可查看，但默认不抢占版面。
5. 现有功能不回退：续写章号、SSE 流式渲染、阅读模式、导出都可用。
6. 单测通过：`WritingConsolePage` 相关用例全绿。
7. Playwright 截图通过：首屏、生成中、高级设置展开、续写可点、右侧面板展开。

## 11. 风险与回滚

1. 风险：一次性改 DOM 较多，容易影响现有选择器测试。  
   处理：先改结构，再补测试，最后改样式。
2. 风险：辅助面板抽屉在窄屏可能溢出。  
   处理：移动端降级为底部 sheet。
3. 回滚：保留旧布局分支，若上线后反馈差可快速回切。

## 12. 待确认决策点

1. 是否采用“B 方案”（主区+右侧抽屉+底部固定操作条）？
2. 顶部预设是否全部下线，只保留一个“模板入口”？
3. 日志默认是否彻底隐藏，仅在用户点开时显示？
4. 高级设置保存是否改为“静默保存 + 失败才提示”？
